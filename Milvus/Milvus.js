import { MilvusClient ,DataType} from "@zilliz/milvus2-sdk-node";
import { config } from "./MilvusConfig.js";
import * as jsonData from "./MilvusJson.js";

import {embeddingOpenAI} from './Embeddings.js'

const { uri, token } = config;
const collection_name = "openai6";
// connecting
console.info(`Connecting to DB: ${uri}`);
const client = new MilvusClient({
    address: uri,
    token: token,
});
console.info(`Success!`);
async function getData(num){
    let data = []
    if(num){
        data = jsonData['json'+num]
    }else{
        for (const key in jsonData) {
            data = data.concat(jsonData[key])
        }
    }
    console.log(data)
    for (const one of data) {
        one.vector = await embeddingOpenAI(one.text)
        // one.vector = [-0.005850952118635178,-0.008313516154885292,-0.004389788489788771,-0.007841157726943493,-0.0199524387717247,0.005838355980813503,-0.02575930394232273,-0.001002975390292704,-0.027862876653671265,-0.02320226840674877,0.002542865229770541,0.005315612070262432,0.0017036410281434655,-0.005016451235860586,0.00245469156652689,-0.01525404304265976,0.019851669669151306,-0.0045440923422575,0.029298847541213036,-0.012697006575763226,0.002838876796886325,0.011928636580705643,-0.012142772786319256,0.016274338588118553,-0.0013800752349197865,0.036932166665792465,0.02562074549496174,-0.009516457095742226,-0.0010478494223207235,-0.03126386180520058,0.00018687699048314244,0.017345018684864044,-0.0013643299462273717,-0.028467494994401932,-0.01425894070416689,-0.01888175867497921,-0.011720798909664154,-0.02141360193490982,0.001837476040236652,-0.013024508953094482,0.012180561199784279,0.011487768031656742,-0.005910784006118774,0.01739540323615074,-0.008282025344669819,0.018201561644673347,-0.010215547867119312,-0.033128101378679276,0.017357613891363144,0.05159418657422066,-0.007072787266224623,0.018629834055900574,-0.028215570375323296,-0.004493707325309515,-0.010284827090799809,0.006663409527391195,0.0025869521778076887,-0.010373000986874104,0.0016327871708199382,-0.008773279376327991,-0.0008077336824499071,0.035848889499902725,-0.03738563135266304,0.002686147578060627,-0.021753700450062752,-0.0009399941773153841,-0.011500364169478416,-0.007633319590240717,-0.02379429154098034,0.0075325495563447475,0.0131504712626338,0.03050808608531952,0.016740398481488228,-0.008269429206848145,0.046026650816202164,-0.012583640404045582,-0.025822285562753677,0.0031065470539033413,-0.03479080647230148,-0.004465365782380104,0.031490594148635864,-0.019839072600007057,0.00797341763973236,0.0048117623664438725,0.015367409214377403,0.025872670114040375,-0.02703152410686016,0.03252348303794861,-0.012407293543219566,0.0011281504994258285,0.014221151359379292,-0.002823131624609232,0.01850387267768383,0.017748098820447922,-0.012325418181717396,0.010051797144114971,-0.011960127390921116,0.009699102491140366,-0.03234713524580002,-0.051090337336063385,0.014359709806740284,-0.007034998387098312,-0.016551455482840538,-0.0010588711593300104,-0.034186188131570816,0.017546558752655983,0.010889447294175625,-0.004326807335019112,0.015279235318303108,-0.02467602863907814,-0.012149070389568806,0.017105689272284508,0.0199902281165123,-0.027283448725938797,-0.0047456324100494385,-0.005765927489846945,0.021816682070493698,0.020405903458595276,-0.016765590757131577,-0.005161308217793703,0.01980128511786461,0.01885656639933586,-0.007438078057020903,-0.019347820430994034,0.027459796518087387,0.018188966438174248,-0.01667741686105728,-0.005161308217793703,-0.005835206713527441,-0.002135062124580145,0.01850387267768383,-0.01869281567633152,0.01224354188889265,0.012117579579353333,-0.013540954329073429,0.01505250297486782,-0.01978868804872036,0.02085936814546585,-0.0006361099658533931,-0.015304427593946457,0.016601840034127235,0.011449979618191719,-0.012136474251747131,0.001594211207702756,0.01758434623479843,-0.008086783811450005,0.02267322689294815,0.004833805840462446,-0.00843318086117506,0.01903291419148445,0.024739010259509087,-0.001002975390292704,0.05046052485704422,0.02033032663166523,0.01197902113199234,0.012753689661622047,-0.011997915804386139,0.025822285562753677,-0.006587831769138575,-0.018289735540747643,-0.01461163442581892,0.01779848337173462,0.01598462462425232,-0.02232053130865097,-0.010637521743774414,0.019322628155350685,-0.032599061727523804,-0.003189997049048543,-0.016639629378914833,0.010738291777670383,-0.00028439940069802105,-0.006990911439061165,-0.015745297074317932,0.016186164692044258,0.0031238668598234653,0.00872289389371872,0.0011580665595829487,-0.00004553834878606722,-0.024184774607419968,0.008886645548045635,-0.035471003502607346,-0.012791479006409645,0.026930755004286766,0.014069996774196625,-0.024046216160058975,0.005684052128344774,-0.005762778222560883,0.0013438609894365072,-0.019347820430994034,-0.009503860957920551,0.008527652360498905,0.05174534022808075,0.0172442477196455,-0.01835271716117859,-0.5969608426094055,-0.021023118868470192,0.011701904237270355,0.00031136322650127113,0.0417439304292202,0.019549360498785973,-0.00040662227547727525,0.023529769852757454,0.008030100725591183,-0.04695877060294151,-0.025708919391036034,0.02286216989159584,0.000024257597033283673,0.003993006888777018,-0.021892260760068893,-0.018982529640197754,-0.005895039066672325,-0.01124214194715023,-0.004704694729298353,-0.01703011244535446,-0.010662714950740337,0.021186871454119682,-0.0019004573114216328,0.007154662627726793,0.022572455927729607,0.0003751316689886153,0.016790783032774925,-0.021501775830984116,-0.0055454932153224945,0.041139308363199234,-0.03176771104335785,0.050561293959617615,0.008376497775316238,-0.002364943502470851,0.05789230391383171,-0.015468179248273373,-0.007066488731652498,0.03574812039732933,0.0032624253071844578,0.01778588630259037,0.004531496204435825,-0.019511571153998375,0.015115484595298767,-0.002796364715322852,0.013591339811682701,0.006638216786086559,0.006008405238389969,-0.010347808711230755,0.016778187826275826,-0.0005140839493833482,0.00005924167635384947,-0.01281037274748087,0.004263826180249453,-0.008508757688105106,-0.006801967974752188,0.013641724362969398,0.018554257228970528,-0.041290465742349625,0.012879651971161366,0.004950321279466152,-0.0018878610571846366,0.02829114906489849,0.0019193516345694661,0.014939136803150177,-0.003213614923879504,0.028568265959620476,-0.006329609081149101,-0.017848867923021317,0.024222563952207565,-0.029802696779370308,0.0006809840560890734,0.017685117200016975,-0.00022771634394302964,-0.0010368278017267585,0.017924444749951363,0.028643842786550522,0.021904855966567993,-0.025469591841101646,-0.00472673773765564,0.0010014008730649948,0.010851657949388027,0.0013533082092180848,0.014737597666680813,-0.02287476696074009,-0.01053675264120102,-0.01743319258093834,-0.012911142781376839,0.02378169633448124,0.016387704759836197,-0.00872289389371872,0.008389093913137913,-0.0029081562533974648,0.0064618694595992565,0.011109881103038788,-0.009831363335251808,0.0030042026191949844,-0.03594965860247612,-0.02374390698969364,0.00230983505025506,-0.01886916346848011,0.010385597124695778,-0.014510865323245525,0.04063545912504196,0.010026604868471622,-0.01981388032436371,0.020620040595531464,-0.04071103781461716,-0.022988133132457733,0.00926453247666359,-0.010505261830985546,0.01997763104736805,-0.026955947279930115,-0.0095290532335639,-0.028442302718758583,0.00242792465724051,-0.008766980841755867,0.028946151956915855,0.008603230118751526,0.02523026242852211,-0.014750193804502487,-0.012489168904721737,0.014019611291587353,0.035093117505311966,0.00005048335515311919,0.014044804498553276,0.04214701056480408,-0.02340380847454071,0.003674952080473304,0.014284132979810238,-0.007570338435471058,0.014624231494963169,-0.04698396474123001,0.015291831456124783,-0.02688037045300007,0.0018453487427905202,-0.02501612715423107,0.0050573889166116714,0.013855860568583012,0.025532571598887444,-0.024902760982513428,-0.027107102796435356,-0.007022402249276638,0.003674952080473304,-0.00567775359377265,-0.007633319590240717,0.0009762083645910025,0.00789154227823019,-0.005491959396749735,0.01224354188889265,0.00835130549967289,-0.013188259676098824,-0.007324711885303259,0.015820873901247978,0.02652767486870289,-0.003804063657298684,0.0038796409498900175,-0.011109881103038788,-0.027308641001582146,0.0008376497426070273,0.006625620648264885,-0.0014643125468865037,0.00407803151756525,-0.03209521248936653,-0.010398193262517452,-0.011449979618191719,-0.0009958900045603514,-0.025633342564105988,-0.010864254087209702,-0.038191791623830795,-0.03413580358028412,0.005693498998880386,-0.0095290532335639,-0.014233747497200966,0.002106720581650734,0.018214158713817596,-0.03209521248936653,-0.0064870622009038925,0.0053250594064593315,-0.023466790094971657,-0.01559414155781269,-0.0021051461808383465,-0.012117579579353333,-0.013830668292939663,-0.017823675647377968,0.009459774009883404,0.004424428101629019,0.01197272352874279,0.02743460424244404,0.002043739426881075,0.014410095289349556,-0.04285239800810814,0.010114777833223343,-0.0026814239099621773,0.008773279376327991,0.025519976392388344,-0.01742059551179409,0.034941960126161575,-0.006556341424584389,-0.013553551398217678,0.013087490573525429,0.010001412592828274,0.011317718774080276,0.00028735166415572166,-0.014359709806740284,0.014926540665328503,-0.017924444749951363,0.007482164539396763,-0.015934240072965622,0.011449979618191719,0.026275750249624252,0.012533255852758884,-0.03229675069451332,-0.00445276964455843,-0.009560544043779373,0.013163067400455475,0.004115820396691561,0.013024508953094482,-0.004134714603424072,-0.009768381714820862,-0.001952416729182005,-0.014296729117631912,0.00507628358900547,0.003791467286646366,-0.017168670892715454,-0.021501775830984116,0.02306370995938778,0.001094298087991774,0.021489180624485016,0.03247309848666191,0.005164457019418478,-0.029525579884648323,-0.015757892280817032,0.010612329468131065,0.01351576205343008,0.012753689661622047,-0.02960115671157837,0.028719419613480568,-0.028215570375323296,0.025519976392388344,-0.008345006965100765,0.003895386354997754,-0.014195959083735943,0.005967467091977596,-0.01758434623479843,0.020468885079026222,0.0027743212413042784,0.04300355166196823,0.026981139555573463,-0.014901348389685154,0.010284827090799809,-0.017848867923021317,-0.004550390411168337,-0.00927083007991314,-0.0038387032691389322,0.02395804226398468,-0.030533278360962868,-0.030356930568814278,0.023693522438406944,0.003804063657298684,0.03282579407095909,0.015896450728178024,0.022912554442882538,0.012451380491256714,0.02234572358429432,0.021690720692276955,0.033505991101264954,-0.02324005775153637,-0.005000706296414137,0.00019356873235665262,-0.012249840423464775,-0.03106231987476349,0.003693846520036459,0.00854024849832058,0.0065248506143689156,0.012514361180365086,-0.018000023439526558,-0.025696324184536934,0.016450686380267143,0.03194405511021614,0.006272925995290279,-0.00889924168586731,-0.03887198865413666,0.0038072126917541027,0.027888068929314613,-0.0026546570006757975,-0.011198054999113083,0.002944370498880744,0.00258852681145072,-0.044212792068719864,0.02632613480091095,0.002840451430529356,0.016072798520326614,-0.00880476925522089,-0.005384891293942928,-0.010656416416168213,0.005457319784909487,0.03501753881573677,-0.022433897480368614,-0.016652224585413933,-0.0034324745647609234,-0.0039552184753119946,-0.010876850225031376,0.012249840423464775,-0.002164978301152587,0.022043414413928986,-0.01189714577049017,-0.012092387303709984,-0.0035867784172296524,0.022899959236383438,-0.021678123623132706,-0.013805476017296314,-0.03879640996456146,-0.04008122533559799,-0.013226049020886421,0.004840103909373283,0.013200856745243073,-0.02084677293896675,-0.03433734178543091,0.023441597819328308,0.0035237972624599934,-0.005000706296414137,-0.006959421094506979,-0.04096296429634094,0.0042921677231788635,0.06726390868425369,0.00934640783816576,0.005872995592653751,0.005627369042485952,-0.022421302273869514,0.013855860568583012,-0.023290442302823067,-0.0007943501695990562,0.004254378844052553,-0.009680207818746567,-0.00279321544803679,0.007986013777554035,-0.005756480153650045,0.006783073768019676,0.009466072544455528,0.00029916063067503273,0.010391895659267902,-0.021867066621780396,0.006200497504323721,-0.005025898572057486,-0.01961234025657177,0.01832752488553524,0.007400289177894592,0.017672520130872726,-0.00104233855381608,-0.00042276119347661734,0.021526968106627464,0.00558643089607358,0.030205776914954185,-0.03940102830529213,-0.0011297250166535378,-0.003687548451125622,-0.013226049020886421,-0.017748098820447922,-0.008017504587769508,0.017886657267808914,0.002538141794502735,0.014296729117631912,-0.010398193262517452,-0.0023491980973631144,0.02017917111515999,0.03652908653020859,0.00762702152132988,-0.008275727741420269,0.004701545462012291,-0.03209521248936653,0.0012706454144790769,0.010398193262517452,0.0027365325950086117,-0.028643842786550522,0.012325418181717396,0.02322746068239212,-0.027837684378027916,-0.027736913412809372,-0.009856555610895157,0.0007329435320571065,-0.01025963481515646,-0.013679513707756996,0.010039201006293297,0.007116873748600483,-0.007198749575763941,-0.016564050689339638,-0.020594848319888115,-0.018969932571053505,-0.009031501598656178,-0.032422713935375214,-0.009000011719763279,-0.018050407990813255,-0.018100792542099953,-0.009119675494730473,0.01507769525051117,-0.007872648537158966,-0.020733406767249107,-0.022421302273869514,0.013956630602478981,0.0013328393688425422,0.03144020587205887,-0.010782378725707531,-0.008685105480253696,0.018415698781609535,0.0018390505574643612,-0.02340380847454071,0.005690350197255611,-0.02578449621796608,-0.01977609284222126,0.011626326479017735,-0.004695247393101454,-0.012319119647145271,0.007412885315716267,0.03645351156592369,0.02466343156993389,0.018642431125044823,0.005060538183897734,0.007368798833340406,0.016123183071613312,0.014762789942324162,0.01922185719013214,-0.002027994254603982,0.0030089260544627905,-0.011336613446474075,-0.017345018684864044,-0.041844699531793594,0.007337308023124933,0.013188259676098824,-0.005280972458422184,0.0019665875006467104,0.03428695723414421,-0.008162361569702625,-0.014737597666680813,0.005306164734065533,0.018982529640197754,-0.029500387609004974,0.019133683294057846,-0.02341640368103981,0.024953145533800125,0.0272330641746521,0.009484966285526752,0.04108892381191254,-0.002027994254603982,-0.021703315898776054,0.019826477393507957,-0.005400636699050665,0.018806181848049164,0.03048289380967617,-0.013112682849168777,0.026829984039068222,0.0014383328380063176,-0.005457319784909487,-0.013654320500791073,-0.0030309695284813643,0.008137169294059277,0.031289052218198776,0.01595943234860897,-0.013843264430761337,-0.0199398435652256,0.005394338630139828,-0.020947542041540146,0.014775386080145836,0.017823675647377968,0.004238633904606104,-0.03154097869992256,-0.012104983441531658,-0.0014312474522739649,0.002538141794502735,0.0000839913118397817,-0.02887057512998581,-0.015568949282169342,0.009018905460834503,-0.0029758610762655735,0.016072798520326614,-0.0024499681312590837,0.022748803719878197,0.004194546956568956,0.0014666743809357285,0.021174274384975433,-0.036932166665792465,-0.028971344232559204,-0.016664821654558182,-0.00989434402436018,-0.001580827753059566,0.024247756227850914,0.016564050689339638,0.01739540323615074,0.007135768420994282,-0.009957325644791126,-0.0008439478697255254,-0.02869422733783722,0.007268028799444437,-0.013767686672508717,0.020594848319888115,0.009617227129638195,0.034916769713163376,-0.02054446190595627,-0.006058789789676666,-0.025142088532447815,0.011468873359262943,-0.01525404304265976,0.012539553456008434,-0.011626326479017735,-0.046732038259506226,0.010637521743774414,0.00372218806296587,-0.017345018684864044,-0.0028184079565107822,0.011198054999113083,-0.0081560630351305,0.008086783811450005,-0.03851929306983948,0.011739692650735378,-0.006408335641026497,0.019322628155350685,-0.030911166220903397,0.0029868825804442167,-0.029248462989926338,0.0029097306542098522,-0.01335201133042574,-0.020733406767249107,-0.006420931778848171,0.018793584778904915,-0.002788492012768984,0.012552150525152683,0.01325124129652977,0.021741105243563652,-0.0019492676947265863,0.004493707325309515,0.018655026331543922,-0.0090566948056221,-0.018201561644673347,0.008200149983167648,-0.010920937173068523,-0.02216937765479088,-0.01686636172235012,-0.0031648045405745506,-0.04441433027386665,0.002043739426881075,0.0019036063458770514,-0.00780966691672802,0.010763484053313732,-0.014536057598888874,-0.002232682891190052,0.010662714950740337,-0.006518552545458078,0.026099402457475662,-0.00045700723421759903,0.03358156606554985,0.03932545334100723,0.01907070353627205,-0.02015397883951664,-0.06439196318387985,0.003041991265490651,0.01461163442581892,0.0042921677231788635,0.028543073683977127,-0.00531246280297637,0.015493371523916721,0.011934934183955193,0.005340804345905781,-0.03652908653020859,-0.013477973639965057,-0.01405740063637495,-0.012035704217851162,0.009919536300003529,-0.013578743673861027,0.0027239362243562937,0.013377203606069088,0.0344633050262928,-0.007784474641084671,-0.028593458235263824,-0.04733666032552719,-0.014221151359379292,0.012287628836929798,0.0030939506832510233,0.00869770161807537,0.014221151359379292,0.009510158561170101,0.01025963481515646,0.003023096825927496,-0.022925151512026787,-0.015178465284407139,0.005674604792147875,-0.012300224974751472,0.04287759214639664,0.011185458861291409,0.017672520130872726,0.010587137192487717,0.033455606549978256,0.005293568596243858,0.009176358580589294,-0.009138570167124271,0.04648011550307274,0.0009344833088107407,-0.0052998666651546955,-0.016387704759836197,-0.01369210984557867,0.02594824880361557,0.03557177260518074,-0.007998610846698284,0.0047834208235144615,0.0015241446672007442,-0.00825683306902647,0.026426905766129494,-0.0035363936331123114,0.005088879726827145,-0.010561944916844368,-0.022597648203372955,-0.026754407212138176,-0.007097979541867971,-0.0044118319638073444,0.016236549243330956,-0.016828572377562523,-0.00011553111107787117,-0.002325580222532153,-0.03416099399328232,0.010870552621781826,0.002933348761871457,-0.022925151512026787,0.00898111704736948,0.01847868040204048,-0.0181133896112442,0.006619322579354048,0.006169007159769535,-0.008571739308536053,-0.011771183460950851,-0.009869151748716831,0.014397499151527882,-0.022018222138285637,0.010001412592828274,-0.0008856729255057871,0.0059076352044939995,-0.015682315453886986,0.00516760628670454,0.007356202229857445,0.007242836058139801,0.004115820396691561,0.05300496518611908,-0.002227959455922246,-0.010064393281936646,-0.021690720692276955,-0.018000023439526558,0.009724294766783714,0.007337308023124933,-0.00080576550681144,-0.005293568596243858,-0.031818095594644547,0.019549360498785973,-0.002525545423850417,0.009006309323012829,-0.00042512299842201173,-0.015442986972630024,-0.023869868367910385,-0.0053282082080841064,-0.001205302425660193,-0.02650248259305954,-0.017521366477012634,-0.025167280808091164,0.004355148877948523,-0.01850387267768383,0.03280059993267059,-0.01617356762290001,0.008382795378565788,0.01866762340068817,0.02143879607319832,-0.004276422318071127,0.02103571593761444,-0.01461163442581892,-0.002051612129434943,0.019171472638845444,-0.041114117950201035,-0.037637557834386826,-0.011210651136934757,-0.0041662054136395454,0.013125278986990452,0.017470980063080788,-0.01461163442581892,-0.037461210042238235,-0.0020028017461299896,-0.03786429017782211,-0.011500364169478416,-0.012545851990580559,0.00890553928911686,-0.011412190273404121,0.017722904682159424,-0.0018154326826334,-0.002101997146382928,-0.022093798965215683,-0.004314211197197437,-0.03355637565255165,-0.02340380847454071,0.026401713490486145,-0.0006172155844978988,-0.0010746164480224252,-0.0007561678648926318,-0.02957596443593502,-0.029827889055013657,-0.00006180028867674991,-0.018289735540747643,0.013289029709994793,0.0005290419794619083,-0.023731309920549393,-0.011002812534570694,-0.018000023439526558,-0.004997557029128075,-0.021816682070493698,0.01189714577049017,-0.015556352213025093,-0.032246366143226624,0.016072798520326614,-0.013528358191251755,-0.008307218551635742,-0.000666813284624368,0.024411506950855255,-0.006776775699108839,-0.002319282153621316,0.025167280808091164,0.005249481648206711,-0.014233747497200966,-0.010687907226383686,0.011198054999113083,0.021451391279697418,0.009560544043779373,-0.0181637741625309,0.03534504026174545,-0.01563193090260029,0.003756827674806118,-0.024575257673859596,0.004515750799328089,0.0031222922261804342,0.01577048934996128,-0.00013422865595202893,-0.006581533700227737,0.028391918167471886,-0.0090566948056221,-0.0048999362625181675,-0.013477973639965057,-0.001958714798092842,0.018995124846696854,-0.0008431606111116707,-0.023844676092267036,0.036932166665792465,0.005517151672393084,-0.016828572377562523,-0.009547947905957699,0.00490938313305378,-0.01614837534725666,0.00825053546577692,-0.010139971040189266,0.002445244463160634,-0.012193157337605953,-0.006002106703817844,-0.003709591692313552,0.002164978301152587,-0.015266639180481434,0.0030608854722231627,-0.0031301649287343025,-0.01705530472099781,-0.0027396816294640303,0.28235724568367004,-0.011443681083619595,-0.004191397689282894,0.006499658338725567,0.007633319590240717,0.02614978887140751,0.03733524680137634,0.004197695758193731,-0.016992323100566864,0.007387693040072918,-0.012571044266223907,0.006499658338725567,0.02703152410686016,-0.00689643993973732,0.007551444228738546,-0.06046193838119507,-0.01252065971493721,-0.011506662704050541,-0.01850387267768383,-0.04028276726603508,0.02194264531135559,0.0021854471415281296,0.016223954036831856,-0.014069996774196625,0.005983212497085333,-0.00835760310292244,0.002106720581650734,-0.013314222916960716,0.019486378878355026,0.01834012195467949,-0.01153185497969389,-0.007910436950623989,0.02252207137644291,0.007727791555225849,-0.015241446904838085,0.014901348389685154,0.021854471415281296,0.004723588936030865,0.02688037045300007,0.002254726365208626,-0.006474465597420931,-0.00526837632060051,0.026754407212138176,-0.0019272242207080126,-0.014384903013706207,0.002366518136113882,-0.016815977171063423,0.007387693040072918,-0.01830233260989189,0.02919807657599449,-0.0056084743700921535,0.007104277610778809,0.029727119952440262,0.02433593012392521,0.007872648537158966,0.015505967661738396,0.03831775113940239,-0.021766297519207,-0.007104277610778809,-0.006442975252866745,0.0074065872468054295,0.046883195638656616,-0.018289735540747643,0.002988457214087248,-0.01884397119283676,0.0007309753564186394,-0.004767675884068012,0.00356158590875566,0.015304427593946457,-0.004153609275817871,-0.019536763429641724,-0.026628445833921432,-0.01007698941975832,-0.004921979736536741,-0.03501753881573677,-0.023177076131105423,0.026552867144346237,0.013654320500791073,0.008867750875651836,0.05300496518611908,-0.027686528861522675,-0.010725695639848709,-0.011575941927731037,0.010127374902367592,-0.012275032699108124,-0.010857956483960152,0.025658534839749336,-0.009302320890128613,-0.0030829289462417364,-0.025633342564105988,-0.009919536300003529,-0.0019287987379357219,0.002399583114311099,-0.01831492781639099,0.0073121157474815845,-0.004641713108867407,0.018453486263751984,0.024373719468712807,-0.018995124846696854,0.011456277221441269,0.004594477359205484,0.01685376465320587,-0.009390494786202908,0.04194546863436699,0.003463965142145753,0.010247038677334785,-0.012218349613249302,-0.008017504587769508,0.007356202229857445,-0.04118969663977623,-0.001302923308685422,-0.03662985563278198,0.00022338639246299863,-0.0002641273313201964,-0.0018579449970275164,0.0061249202117323875,-0.023504577577114105,-0.010965024121105671,0.016627032309770584,-0.018655026331543922,0.04315470904111862,-0.03574812039732933,-0.004065435379743576,0.03975372388958931,-0.013011912815272808,-0.035471003502607346,-0.018214158713817596,0.004396086558699608,-0.007658511865884066,-0.05769076570868492,0.015846066176891327,-0.016803380101919174,0.03353118151426315,0.002254726365208626,-0.010328914038836956,0.02143879607319832,-0.01579568162560463,-0.01614837534725666,0.015002118423581123,-0.016299530863761902,0.0005479363026097417,-0.016286933794617653,0.014447883702814579,0.026225365698337555,0.025368820875883102,-0.0020106742158532143,0.014510865323245525,0.0030545874033123255,0.01471240445971489,-0.009554245509207249,-0.0272330641746521,-0.004969215486198664,0.03141501545906067,0.019498974084854126,0.01189084816724062,0.017659924924373627,-0.014926540665328503,0.006266627926379442,-0.01944858953356743,0.02433593012392521,-0.023479385301470757,0.006181603297591209,0.028089608997106552,-0.013805476017296314,-0.01686636172235012,-0.010813869535923004,-0.15579025447368622,0.006272925995290279,0.02428554557263851,-0.03217078745365143,0.0016359363216906786,0.0054541705176234245,0.02012878656387329,-0.015442986972630024,0.002823131624609232,0.013654320500791073,0.016639629378914833,0.00011848335270769894,-0.011808971874415874,-0.0381414070725441,-0.006266627926379442,-0.015392601490020752,-0.02106090821325779,0.016627032309770584,0.060361169278621674,0.021766297519207,0.019020317122340202,-0.009277128614485264,-0.006827160250395536,0.0254192054271698,0.003133313963189721,0.03305252641439438,0.01925964653491974,-0.011966424994170666,-0.011298824101686478,-0.01106579415500164,-0.03519388660788536,-0.005551791284233332,0.000634141790214926,-0.013918842189013958,0.02033032663166523,-0.008704000152647495,0.018390506505966187,0.006720092613250017,-0.03889717906713486,0.026603251695632935,0.011626326479017735,0.024235159158706665,0.0013643299462273717,0.009359003975987434,0.011109881103038788,0.004906234331429005,0.012508063577115536,0.024801990017294884,-0.0013769262004643679,-0.004109522327780724,0.005425828974694014,-0.012948931194841862,0.030936358496546745,0.007255432661622763,0.010731994174420834,0.015304427593946457,0.016425492241978645,0.027636144310235977,0.007085383404046297,-0.007841157726943493,0.0023145584855228662,-0.01597202755510807,0.027636144310235977,-0.010637521743774414,-0.003498604753986001,0.021451391279697418,-0.011941232718527317,0.0065752356313169,-0.01580827683210373,-0.001498164958320558,0.00788524467498064,0.0006573661230504513,0.021841874346137047,-0.010184057988226414,-0.016085393726825714,-0.009277128614485264,-0.017483577132225037,0.027308641001582146,-0.004739334341138601,-0.008313516154885292,-0.035118307918310165,0.023680925369262695,-0.03252348303794861,0.0005459681269712746,0.023013325408101082,0.030356930568814278,0.02324005775153637,-0.029147692024707794,-0.03227156028151512,-0.009113377891480923,0.036201585084199905,-0.019927246496081352,-0.023340826854109764,0.007507357280701399,0.03217078745365143,-0.018000023439526558,0.006433527916669846,0.017647327855229378,-0.016072798520326614,0.008578037843108177,-0.005186500493437052,-0.02960115671157837,-0.006871247198432684,0.034564074128866196,0.008603230118751526,0.008426882326602936,0.0028325787279754877,0.03390907123684883,0.02415958233177662,-0.011575941927731037,-0.015493371523916721,0.005504555534571409,0.02738421969115734,0.01704270951449871,-0.011557047255337238,0.0047172908671200275,-0.019284838810563087,-0.032926563173532486,0.03249829262495041,-0.029273655265569687,-0.0023003877140581608,0.012722199782729149,0.01532962080091238,0.010857956483960152,-0.007456972263753414,-0.022937746718525887,-0.03466484323143959,-0.024638239294290543,0.023731309920549393,0.014485672116279602,-0.003498604753986001,0.027333835139870644,0.009352706372737885,0.022937746718525887,-0.0042291865684092045,0.01580827683210373,-0.0031852733809500933,-0.044011250138282776,0.0008049782481975853,0.009850257076323032,-0.0033474499359726906,-0.004884190857410431,0.01744578778743744,-0.032246366143226624,0.01580827683210373,0.03375791385769844,0.0025160983204841614,-0.010669012553989887,0.010713099502027035,-0.0031065470539033413,-0.0345136895775795,0.011720798909664154,-0.03048289380967617,0.0014887177385389805,0.03685658797621727,-0.010095884092152119,0.007488463073968887,-0.022093798965215683,-0.009396792389452457,-0.014913944527506828,-0.020443692803382874,-0.008842558600008488,-0.05643114075064659,-0.02555776573717594,0.01961234025657177,-0.014498269185423851,-0.011626326479017735,-0.018730605021119118,0.013477973639965057,-0.022219762206077576,-0.028744611889123917,0.0028530475683510303,-0.02652767486870289,0.025721516460180283,0.017672520130872726,-0.026729214936494827,-0.033329643309116364,-0.019461186602711678,-0.016727803274989128,-0.013503165915608406,0.034740421921014786,-0.027560565620660782,0.013603935949504375,-0.015556352213025093,-0.030961550772190094,0.00851505622267723,0.007104277610778809,-0.00014406946138478816,-0.00880476925522089,-0.01505250297486782,-0.004219739232212305,-0.005769076757133007,-0.005627369042485952,-0.023328231647610664,0.035672541707754135,-0.014221151359379292,-0.019675321877002716,0.019524168223142624,-0.01779848337173462,0.008924433961510658,-0.007690002676099539,-0.01653885841369629,-0.011009111069142818,-0.016752995550632477,0.03751159459352493,-0.04824358597397804,0.007211345713585615,-0.021665528416633606,0.00516760628670454,-0.009925834834575653,-0.00752625148743391,-0.002410604851320386,0.013200856745243073,-0.025545168668031693,0.02340380847454071,-0.024789394810795784,-0.017874060198664665,0.03904833644628525,0.014838366769254208,-0.01579568162560463,0.008817366324365139,-0.012898546643555164,0.014813174493610859,0.005413232836872339,-0.008628422394394875,0.022648034617304802,0.011103582568466663,-0.021678123623132706,-0.08766981214284897,0.013553551398217678,0.007904138416051865,0.00319629511795938,0.02647729031741619,-0.0009494413388893008,0.010776081122457981,-0.005813163239508867,-0.01522885076701641,0.0017162372823804617,-0.030432509258389473,0.002512949286028743,-0.013452781364321709,0.006345354486256838,-0.007393991108983755,0.005756480153650045,-0.004266975447535515,0.003172677243128419,0.025003530085086823,0.011160265654325485,-0.00766481040045619,-0.0077403876930475235,0.018944740295410156,0.009050396271049976,-0.00923934020102024,-0.0027160635218024254,-0.02016657590866089,0.016022413969039917,-0.03171732649207115,0.006191050633788109,0.011884549632668495,-0.024625644087791443,-0.0023901360109448433,0.02233312837779522,-0.00553289707750082,-0.02216937765479088,0.018831374123692513,0.0032151895575225353,-0.022358320653438568,0.035823699086904526,-0.007009805645793676,-0.00036470041959546506,0.029147692024707794,-0.008130870759487152,0.0035300953313708305,0.01595943234860897,-0.01561933383345604,0.016425492241978645,0.03758716955780983,-0.02160254679620266,-0.0050542401149868965,0.006631918717175722,-0.0019681621342897415,-0.012741093523800373,0.00029935743077658117,-0.034488495439291,0.0254066102206707,-0.0010588711593300104,-0.007230239920318127,-0.0061249202117323875,0.004755079280585051,0.013465377502143383,0.018818778917193413,-0.010221846401691437,0.00825683306902647,0.005756480153650045,-0.01424634363502264,0.0027459796983748674,0.020657828077673912,-0.014586442150175571,-0.030533278360962868,0.0069783153012394905,-0.000799073779489845,0.02177889458835125,-0.008048995397984982,0.03642831742763519,0.019713111221790314,-0.0018831373890861869,-0.01296152826398611,0.03607562184333801,0.012495467439293861,0.039678145200014114,-0.020960139110684395,0.021275043487548828,0.0011612155940383673,0.0005278610624372959,0.006165857892483473,0.021111292764544487,0.008193852379918098,0.016022413969039917,-0.01205459889024496,0.006776775699108839,-0.005740735214203596,-0.005280972458422184,0.021816682070493698,0.018377909436821938,-0.004386639688163996,-0.01889435574412346,0.03531984984874725,0.03466484323143959,0.0000037056800010759616,-0.01398182287812233,0.015493371523916721,-0.0030892270151525736,-0.03660466521978378,-0.001233643968589604,-0.027132295072078705,-0.01224354188889265,-0.002456266200169921,-0.006005255971103907,0.0016973429592326283,0.01721905544400215,0.005148712079972029,0.02124985121190548,-0.0006742923287674785,-0.020443692803382874,0.007356202229857445,-0.022093798965215683,-0.009799872525036335,0.012067195028066635,0.005536046344786882,0.0021744254045188427,0.02957596443593502,-0.03824217617511749,0.007488463073968887,0.005857250187546015,0.01920926198363304,-0.028190378099679947,0.015216254629194736,-0.0075325495563447475,0.01616097241640091,0.007205047644674778,-0.03690697252750397,0.0019917800091207027,-0.017345018684864044,0.00744437612593174,0.004414981231093407,0.0025050765834748745,0.00025960057973861694,0.023340826854109764,0.013314222916960716,0.00398670881986618,-0.006225690245628357,-0.0026892966125160456,0.011487768031656742,0.01944858953356743,-0.017521366477012634,-0.009573140181601048,-0.0005829695728607476,-0.008559143170714378,-0.030432509258389473,0.004852700512856245,-0.007696300745010376,-0.04396086558699608,-0.01924704946577549,-0.01551856379956007,0.018554257228970528,-0.013578743673861027,0.005000706296414137,0.016085393726825714,-0.0122561389580369,0.026981139555573463,0.003860746743157506,-0.03101193532347679,0.0057533313520252705,0.023895060643553734,0.0014910795725882053,0.009157463908195496,-0.026099402457475662,0.006131218280643225,0.010750887915492058,-0.012608833611011505,-0.02194264531135559,0.024424104019999504,-0.019310031086206436,-0.010530454106628895,0.00833870843052864,0.03484119102358818,-0.005674604792147875,-0.009314917027950287,-0.02339121140539646,-0.014460479840636253,-0.003980410750955343,0.024361122399568558,-0.005280972458422184,0.01187825109809637,-0.016916746273636818,-0.020078402012586594]
    }
    return data
}
// 创建collection，并插入数据
export const createData =async ()=>{

    // create colleciton
    console.time(`Creating example collection: ${collection_name}`);
    const schema = [
        {
            name: 'id',
            description: 'ID field',
            data_type: DataType.Int64,
            is_primary_key: true,
            autoID: true,
        },
        {
            name: 'answer',
            description: '',
            data_type: DataType.VarChar,
            max_length: 8000,
        },
        {
            name: 'vector',
            description: 'Vector field',
            data_type: DataType.FloatVector,
            dim: 1536,
        },
        {
            name: 'text',
            description: 'VarChar field',
            data_type: DataType.VarChar,
            max_length: 8000,
        },
    ]
    await client.createCollection({
        collection_name,
        fields:schema,
    });
    await client.createIndex({
        // required
        collection_name,
        field_name: 'vector',
        index_name: 'openaiindex',
    });
    console.timeEnd(`Creating example collection: ${collection_name}`);

    const data = await getData();
    // console.log(data)
    await client.insert({
        collection_name,
        data,
    });

}
export const insertData =async (num)=>{

    const data = await getData(num);
    // console.log(data)
    await client.insert({
        collection_name,
        data,
    });
}
// 查找数据
export const searchData =async (str)=>{
    await client.loadCollectionSync({
        collection_name,
    });
    let vector =await embeddingOpenAI(str)
    const res = await client.search({
        collection_name,
        vector: vector,
        output_fields: ["id",'text','answer'],
        limit: 10,
    });
    console.log('vector::::',res)
    return res

}
// 获取一条数据
export const getOneData =async (id)=>{
    await client.loadCollectionSync({
        collection_name,
    });
    let data = await client.get({
        collection_name,
        ids:[id],
        output_fields: ["id",'text'],
    })
    if(!data)return null
    data = data.data
    if(data&&data.length>0){
        return data[0].text
    }
    return null
}
// 筛选数据
export const getAnswerData = async (str)=>{
    let data = await searchData(str)
    if(!data)return null
    if(data.results&&data.results.length>0){
        if(data.results[0].score>0.88){
            // let da = await getOneData(data.results[0].answer)
            let da = data.results[0]
            console.log('data::::',da)
            return da
        }
    }
    return null
}
// 注销Collection
export const dropCollection = async ()=>{
    await client.dropCollection({
        collection_name,
    })
}

